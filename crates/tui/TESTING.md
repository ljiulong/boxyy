# Boxy TUI 测试文档

本文档用于验证 Boxy TUI 的基础体验、交互、性能与稳定性。

## 1. 环境准备

### 1.1 依赖
- macOS 终端
- Rust 1.74+
- 已安装至少 1 个包管理器（推荐 `brew` 或 `npm`）

### 1.2 进入项目
```bash
cd "/Volumes/HuaWei Mate 990 EVO PLUS/xiaomi car/mac-app/boxy/boxy"
```

### 1.3 构建
```bash
cargo build -p boxy-tui
```

## 2. 启动与退出

### 2.1 启动
```bash
cargo run -p boxy-tui
```

**预期**：进入 TUI，看到三栏布局（管理器/包/详情），底部有使用指南与状态栏。

### 2.2 退出
- 按 `Ctrl+C` 退出
- 或按 `q` 退出

**预期**：终端恢复正常，光标与回显正常。

## 3. 布局与显示

### 3.1 三栏布局
- 左：管理器列表
- 中：包列表
- 右：包详情

**预期**：三栏宽度比例 25% / 50% / 25%。

### 3.2 管理器颜色区分
- 可用管理器：绿色 `[+]`，名称正常亮度
- 不可用管理器：红色 `[x]`，名称灰色

### 3.3 使用指南
底部使用指南应显示：
- `Ctrl+C` 退出
- `?` 帮助
- `/` 搜索
- `j/k` 移动
- `h/l` 切换管理器

## 4. 键盘交互

### 4.1 基本导航
- `j / k` 或 `Up / Down`：移动包列表选择
- `h / l` 或 `Left / Right`：切换管理器

**预期**：选择项变化及时，详情栏更新。

### 4.2 搜索模式
- 按 `/` 进入搜索
- 输入关键字过滤包
- `Enter` 应用搜索
- `Esc` 退出并清空搜索

**预期**：包列表被过滤，退出后恢复全部包。

### 4.3 详情视图
- `Enter` 进入包详情
- `b` 或 `Esc` 返回

**预期**：进入详情后看到更多信息，返回恢复原视图。

### 4.4 帮助面板
- 按 `?` 打开/关闭帮助

**预期**：帮助面板覆盖显示，关闭后恢复。

## 5. 数据刷新

### 5.1 手动刷新
- 按 `r`

**预期**：状态栏提示刷新，包列表在后台更新，不卡顿。

### 5.2 自动刷新
- 等待 30 秒

**预期**：后台刷新后状态消息变化，UI 无明显卡顿。

## 6. 性能与卡顿测试

### 6.1 切换管理器
- 连续按 `h/l` 切换 10 次

**预期**：UI 不冻结，包加载在后台进行。

### 6.2 包列表滚动
- 长列表快速按 `j`/`k`

**预期**：选择移动流畅，无明显掉帧。

### 6.3 重绘稳定性
- 调整终端大小

**预期**：布局自适应，无崩溃或花屏。

## 7. 写操作（可选）

> 注意：以下操作会修改本机环境，请使用可安全卸载的包。

### 7.1 更新
- 选中包后按 `u`
- 在确认弹窗按 `Enter`

**预期**：状态栏提示任务运行，日志可查看。

### 7.2 卸载
- 选中包后按 `d`
- 在确认弹窗按 `Enter`

**预期**：包被卸载，列表更新。

### 7.3 查看日志
- 按 `L`

**预期**：显示最近任务日志。

## 8. 常见问题检查

### 8.1 管理器不可用
- 断开 PATH 中某个管理器（或未安装）

**预期**：显示红色 `[x]`，不会卡死。

### 8.2 搜索空结果
- 搜索不存在的包名

**预期**：列表为空，不崩溃。

## 9. 回归清单

- [ ] `Ctrl+C` 可退出
- [ ] `q` 可退出
- [ ] 三栏布局显示正常
- [ ] 管理器颜色区分正确
- [ ] 使用指南显示在底部
- [ ] 搜索模式可进可退
- [ ] 刷新不阻塞 UI
- [ ] 帮助面板可切换
- [ ] 终端退出后恢复正常
